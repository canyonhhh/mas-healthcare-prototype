{"agent": "ingestion", "artifacts": [{"name": "admissions_base", "path": "artifacts/admissions_base.csv", "rows": 275, "schema": ["subject_id", "hadm_id", "admittime", "dischtime", "deathtime", "admission_type", "admit_provider_id", "admission_location", "discharge_location", "insurance", "language", "marital_status", "race", "edregtime", "edouttime", "hospital_expire_flag", "gender", "anchor_age", "anchor_year", "anchor_year_group", "dod"], "lineage": ["patients", "admissions"]}, {"name": "admission_diagnoses", "path": "artifacts/admission_diagnoses.csv", "rows": 4506, "schema": ["subject_id", "hadm_id", "seq_num", "icd_code", "icd_version"], "lineage": ["diagnoses_icd"]}, {"name": "admission_labs", "path": "artifacts/admission_labs.csv", "rows": 107727, "schema": ["labevent_id", "subject_id", "hadm_id", "specimen_id", "itemid", "order_provider_id", "charttime", "storetime", "value", "valuenum", "valueuom", "ref_range_lower", "ref_range_upper", "flag", "priority", "comments"], "lineage": ["labevents"]}], "checks": [{"name": "patients_subject_id_unique", "status": "pass", "details": "Each subject_id should be unique in patients.", "metrics": {"unique": 1, "rows": 100}}, {"name": "admissions_hadm_id_unique", "status": "pass", "details": "Each hadm_id should be unique in admissions.", "metrics": {"unique": 1, "rows": 275}}, {"name": "missing_keys", "status": "warn", "details": "Missing hadm_id in diagnoses or labs.", "metrics": {"missing_diagnoses": 0, "missing_labs": 28420}}, {"name": "orphan_records", "status": "warn", "details": "Records pointing to unknown hadm_id.", "metrics": {"diagnoses_orphan_fraction": 0.0, "labs_orphan_fraction": 0.26381501387767226}}], "metrics": {"patients_rows": 100, "admissions_rows": 275, "diagnoses_rows": 4506, "labs_rows": 107727}, "notes": "Loaded source CSVs and wrote normalized admissions/diagnoses/labs tables.", "stop": false}
{"agent": "normalization", "artifacts": [{"name": "diagnoses_normalized", "path": "artifacts/diagnoses_normalized.csv", "rows": 4506, "schema": ["subject_id", "hadm_id", "seq_num", "icd_code", "icd_version", "long_title", "diagnosis_name", "mapped"], "lineage": ["admission_diagnoses", "d_icd_diagnoses"]}, {"name": "labs_normalized", "path": "artifacts/labs_normalized.csv", "rows": 107727, "schema": ["labevent_id", "subject_id", "hadm_id", "specimen_id", "itemid", "order_provider_id", "charttime", "storetime", "value", "valuenum", "valueuom", "ref_range_lower", "ref_range_upper", "flag", "priority", "comments", "label", "fluid", "category", "lab_label", "mapped", "unit_status"], "lineage": ["admission_labs", "d_labitems"]}], "checks": [{"name": "diagnosis_mapping", "status": "pass", "details": "Mapped ICD codes to long titles; unmapped remain flagged.", "metrics": {"mapped_fraction": 1.0}}, {"name": "labitem_mapping", "status": "pass", "details": "Mapped lab itemids to labels; unmapped remain flagged.", "metrics": {"mapped_fraction": 1.0}}, {"name": "unit_consistency", "status": "warn", "details": "Value units should be consistent per itemid.", "metrics": {"inconsistent_itemids": [51249, 50915, 51099, 51654]}}], "metrics": {"diagnoses_total": 4506, "diagnoses_mapped": 1.0, "labs_total": 107727, "labs_mapped": 1.0, "lab_items_inconsistent_units": 4}, "notes": "Normalized diagnoses and labs with mapping and unit status.", "stop": false}
{"agent": "analysis", "artifacts": [{"name": "features_by_admission", "path": "artifacts/features_by_admission.csv", "rows": 275, "schema": ["hadm_id", "subject_id", "admittime", "dischtime", "length_of_stay_hours", "num_diagnoses", "num_abnormal_labs", "risk_flag"], "lineage": ["admissions_base", "diagnoses_normalized", "labs_normalized"]}], "checks": [{"name": "los_non_negative", "status": "pass", "details": "Length of stay should be non-negative.", "metrics": {"negative_rows": 0}}, {"name": "features_non_missing", "status": "pass", "details": "Critical features should not be missing.", "metrics": {"rows_with_missing": 0}}], "metrics": {"hadm_count": 275, "risk_flag_rate": 0.9818181818181818}, "notes": "Computed counts, LOS, and a simple rule-based risk flag.", "stop": false}
{"agent": "safety", "artifacts": [{"name": "safety_report", "path": "artifacts/safety_report.json", "rows": 1, "schema": ["status", "checks", "metrics", "generated_at"], "lineage": ["features_by_admission", "labs_normalized", "diagnoses_normalized"]}], "checks": [{"name": "no_future_labs", "status": "fail", "details": "Lab charttime should not exceed discharge time.", "metrics": {"future_labs": 199}}, {"name": "plausible_ranges", "status": "warn", "details": "Lab values outside plausible bounds are flagged.", "metrics": {"out_of_range_count": 95}}, {"name": "dx_lab_coherence_diabetes_glucose", "status": "warn", "details": "Admissions with diagnosis containing 'diabetes' missing labs containing 'glucose'.", "metrics": {"hadm_ids": [20900955, 22416954, 23143086, 23199774, 24096336, 26739864, 27125816, 28778757, 28984460]}}, {"name": "dx_lab_coherence_renal_creatinine", "status": "warn", "details": "Admissions with diagnosis containing 'renal' missing labs containing 'creatinine'.", "metrics": {"hadm_ids": [22416954, 22999601, 27504040]}}, {"name": "lab_missingness", "status": "pass", "details": "Fraction of admissions without any labs.", "metrics": {"missing_fraction": 0.08363636363636362}}], "metrics": {"future_labs": 199, "out_of_range_labs": 95, "labs_missing_fraction": 0.08363636363636362}, "notes": "Safety checks for leakage, plausible ranges, dx-lab coherence, and lab missingness.", "stop": true}
{"agent": "reporting", "artifacts": [{"name": "report_md", "path": "artifacts/report.md", "rows": 0, "schema": [], "lineage": ["features_by_admission", "safety_report"]}, {"name": "audit_summary_md", "path": "artifacts/audit_summary.md", "rows": 0, "schema": [], "lineage": []}], "checks": [], "metrics": {"risk_flag_rate": 0.9818181818181818}, "notes": "Generated cohort/feature/risk summaries and audit log extracts.", "stop": true}
{"agent": "ingestion", "artifacts": [{"name": "admissions_base", "path": "artifacts/admissions_base.csv", "rows": 275, "schema": ["subject_id", "hadm_id", "admittime", "dischtime", "deathtime", "admission_type", "admit_provider_id", "admission_location", "discharge_location", "insurance", "language", "marital_status", "race", "edregtime", "edouttime", "hospital_expire_flag", "gender", "anchor_age", "anchor_year", "anchor_year_group", "dod"], "lineage": ["patients", "admissions"]}, {"name": "admission_diagnoses", "path": "artifacts/admission_diagnoses.csv", "rows": 4506, "schema": ["subject_id", "hadm_id", "seq_num", "icd_code", "icd_version"], "lineage": ["diagnoses_icd"]}, {"name": "admission_labs", "path": "artifacts/admission_labs.csv", "rows": 107727, "schema": ["labevent_id", "subject_id", "hadm_id", "specimen_id", "itemid", "order_provider_id", "charttime", "storetime", "value", "valuenum", "valueuom", "ref_range_lower", "ref_range_upper", "flag", "priority", "comments"], "lineage": ["labevents"]}], "checks": [{"name": "patients_subject_id_unique", "status": "pass", "details": "Each subject_id should be unique in patients.", "metrics": {"unique": 1, "rows": 100}}, {"name": "admissions_hadm_id_unique", "status": "pass", "details": "Each hadm_id should be unique in admissions.", "metrics": {"unique": 1, "rows": 275}}, {"name": "missing_keys", "status": "warn", "details": "Missing hadm_id in diagnoses or labs.", "metrics": {"missing_diagnoses": 0, "missing_labs": 28420}}, {"name": "orphan_records", "status": "warn", "details": "Records pointing to unknown hadm_id.", "metrics": {"diagnoses_orphan_fraction": 0.0, "labs_orphan_fraction": 0.26381501387767226}}], "metrics": {"patients_rows": 100, "admissions_rows": 275, "diagnoses_rows": 4506, "labs_rows": 107727}, "notes": "Loaded source CSVs and wrote normalized admissions/diagnoses/labs tables.", "stop": false}
{"agent": "normalization", "artifacts": [{"name": "diagnoses_normalized", "path": "artifacts/diagnoses_normalized.csv", "rows": 4506, "schema": ["subject_id", "hadm_id", "seq_num", "icd_code", "icd_version", "long_title", "diagnosis_name", "mapped"], "lineage": ["admission_diagnoses", "d_icd_diagnoses"]}, {"name": "labs_normalized", "path": "artifacts/labs_normalized.csv", "rows": 107727, "schema": ["labevent_id", "subject_id", "hadm_id", "specimen_id", "itemid", "order_provider_id", "charttime", "storetime", "value", "valuenum", "valueuom", "ref_range_lower", "ref_range_upper", "flag", "priority", "comments", "label", "fluid", "category", "lab_label", "mapped", "unit_status"], "lineage": ["admission_labs", "d_labitems"]}], "checks": [{"name": "diagnosis_mapping", "status": "pass", "details": "Mapped ICD codes to long titles; unmapped remain flagged.", "metrics": {"mapped_fraction": 1.0}}, {"name": "labitem_mapping", "status": "pass", "details": "Mapped lab itemids to labels; unmapped remain flagged.", "metrics": {"mapped_fraction": 1.0}}, {"name": "unit_consistency", "status": "warn", "details": "Value units should be consistent per itemid.", "metrics": {"inconsistent_itemids": [51249, 50915, 51099, 51654]}}], "metrics": {"diagnoses_total": 4506, "diagnoses_mapped": 1.0, "labs_total": 107727, "labs_mapped": 1.0, "lab_items_inconsistent_units": 4}, "notes": "Normalized diagnoses and labs with mapping and unit status.", "stop": false}
{"agent": "analysis", "artifacts": [{"name": "features_by_admission", "path": "artifacts/features_by_admission.csv", "rows": 275, "schema": ["hadm_id", "subject_id", "admittime", "dischtime", "length_of_stay_hours", "num_diagnoses", "num_abnormal_labs", "risk_flag"], "lineage": ["admissions_base", "diagnoses_normalized", "labs_normalized"]}], "checks": [{"name": "los_non_negative", "status": "pass", "details": "Length of stay should be non-negative.", "metrics": {"negative_rows": 0}}, {"name": "features_non_missing", "status": "pass", "details": "Critical features should not be missing.", "metrics": {"rows_with_missing": 0}}], "metrics": {"hadm_count": 275, "risk_flag_rate": 0.9818181818181818}, "notes": "Computed counts, LOS, and a simple rule-based risk flag.", "stop": false}
{"agent": "safety", "artifacts": [{"name": "safety_report", "path": "artifacts/safety_report.json", "rows": 1, "schema": ["status", "checks", "metrics", "generated_at"], "lineage": ["features_by_admission", "labs_normalized", "diagnoses_normalized"]}], "checks": [{"name": "no_future_labs", "status": "warn", "details": "Lab charttime should not exceed discharge time.", "metrics": {"future_labs": 199}}, {"name": "plausible_ranges", "status": "warn", "details": "Lab values outside plausible bounds are flagged.", "metrics": {"out_of_range_count": 95}}, {"name": "dx_lab_coherence_diabetes_glucose", "status": "warn", "details": "Admissions with diagnosis containing 'diabetes' missing labs containing 'glucose'.", "metrics": {"hadm_ids": [20900955, 22416954, 23143086, 23199774, 24096336, 26739864, 27125816, 28778757, 28984460]}}, {"name": "dx_lab_coherence_renal_creatinine", "status": "warn", "details": "Admissions with diagnosis containing 'renal' missing labs containing 'creatinine'.", "metrics": {"hadm_ids": [22416954, 22999601, 27504040]}}, {"name": "lab_missingness", "status": "pass", "details": "Fraction of admissions without any labs.", "metrics": {"missing_fraction": 0.08363636363636362}}], "metrics": {"future_labs": 199, "out_of_range_labs": 95, "labs_missing_fraction": 0.08363636363636362}, "notes": "Safety checks for leakage, plausible ranges, dx-lab coherence, and lab missingness.", "stop": false}
{"agent": "reporting", "artifacts": [{"name": "report_md", "path": "artifacts/report.md", "rows": 0, "schema": [], "lineage": ["features_by_admission", "safety_report"]}, {"name": "audit_summary_md", "path": "artifacts/audit_summary.md", "rows": 0, "schema": [], "lineage": []}], "checks": [], "metrics": {"risk_flag_rate": 0.9818181818181818}, "notes": "Generated cohort/feature/risk summaries and audit log extracts.", "stop": true}
{"agent": "ingestion", "artifacts": [{"name": "admissions_base", "path": "artifacts/admissions_base.csv", "rows": 275, "schema": ["subject_id", "hadm_id", "admittime", "dischtime", "deathtime", "admission_type", "admit_provider_id", "admission_location", "discharge_location", "insurance", "language", "marital_status", "race", "edregtime", "edouttime", "hospital_expire_flag", "gender", "anchor_age", "anchor_year", "anchor_year_group", "dod"], "lineage": ["patients", "admissions"]}, {"name": "admission_diagnoses", "path": "artifacts/admission_diagnoses.csv", "rows": 4506, "schema": ["subject_id", "hadm_id", "seq_num", "icd_code", "icd_version"], "lineage": ["diagnoses_icd"]}, {"name": "admission_labs", "path": "artifacts/admission_labs.csv", "rows": 107727, "schema": ["labevent_id", "subject_id", "hadm_id", "specimen_id", "itemid", "order_provider_id", "charttime", "storetime", "value", "valuenum", "valueuom", "ref_range_lower", "ref_range_upper", "flag", "priority", "comments"], "lineage": ["labevents"]}], "checks": [{"name": "patients_subject_id_unique", "status": "pass", "details": "Each subject_id should be unique in patients.", "metrics": {"unique": 1, "rows": 100}}, {"name": "admissions_hadm_id_unique", "status": "pass", "details": "Each hadm_id should be unique in admissions.", "metrics": {"unique": 1, "rows": 275}}, {"name": "missing_keys", "status": "warn", "details": "Missing hadm_id in diagnoses or labs.", "metrics": {"missing_diagnoses": 0, "missing_labs": 28420}}, {"name": "orphan_records", "status": "warn", "details": "Records pointing to unknown hadm_id.", "metrics": {"diagnoses_orphan_fraction": 0.0, "labs_orphan_fraction": 0.26381501387767226}}], "metrics": {"patients_rows": 100, "admissions_rows": 275, "diagnoses_rows": 4506, "labs_rows": 107727}, "notes": "Loaded source CSVs and wrote normalized admissions/diagnoses/labs tables.", "stop": false}
{"agent": "normalization", "artifacts": [{"name": "diagnoses_normalized", "path": "artifacts/diagnoses_normalized.csv", "rows": 4506, "schema": ["subject_id", "hadm_id", "seq_num", "icd_code", "icd_version", "long_title", "diagnosis_name", "mapped"], "lineage": ["admission_diagnoses", "d_icd_diagnoses"]}, {"name": "labs_normalized", "path": "artifacts/labs_normalized.csv", "rows": 107727, "schema": ["labevent_id", "subject_id", "hadm_id", "specimen_id", "itemid", "order_provider_id", "charttime", "storetime", "value", "valuenum", "valueuom", "ref_range_lower", "ref_range_upper", "flag", "priority", "comments", "label", "fluid", "category", "lab_label", "mapped", "unit_status"], "lineage": ["admission_labs", "d_labitems"]}], "checks": [{"name": "diagnosis_mapping", "status": "pass", "details": "Mapped ICD codes to long titles; unmapped remain flagged.", "metrics": {"mapped_fraction": 1.0}}, {"name": "labitem_mapping", "status": "pass", "details": "Mapped lab itemids to labels; unmapped remain flagged.", "metrics": {"mapped_fraction": 1.0}}, {"name": "unit_consistency", "status": "warn", "details": "Value units should be consistent per itemid.", "metrics": {"inconsistent_itemids": [51249, 50915, 51099, 51654]}}], "metrics": {"diagnoses_total": 4506, "diagnoses_mapped": 1.0, "labs_total": 107727, "labs_mapped": 1.0, "lab_items_inconsistent_units": 4}, "notes": "Normalized diagnoses and labs with mapping and unit status.", "stop": false}
{"agent": "analysis", "artifacts": [{"name": "features_by_admission", "path": "artifacts/features_by_admission.csv", "rows": 275, "schema": ["hadm_id", "subject_id", "admittime", "dischtime", "length_of_stay_hours", "num_diagnoses", "num_abnormal_labs", "risk_flag"], "lineage": ["admissions_base", "diagnoses_normalized", "labs_normalized"]}], "checks": [{"name": "los_non_negative", "status": "pass", "details": "Length of stay should be non-negative.", "metrics": {"negative_rows": 0}}, {"name": "features_non_missing", "status": "pass", "details": "Critical features should not be missing.", "metrics": {"rows_with_missing": 0}}], "metrics": {"hadm_count": 275, "risk_flag_rate": 0.9818181818181818}, "notes": "Computed counts, LOS, and a simple rule-based risk flag.", "stop": false}
{"agent": "reporting", "artifacts": [{"name": "report_md", "path": "artifacts/report.md", "rows": 0, "schema": [], "lineage": ["features_by_admission", "safety_report"]}, {"name": "audit_summary_md", "path": "artifacts/audit_summary.md", "rows": 0, "schema": [], "lineage": []}], "checks": [], "metrics": {"risk_flag_rate": 0.9818181818181818}, "notes": "Generated cohort/feature/risk summaries and audit log extracts.", "stop": true}
